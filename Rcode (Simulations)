This code is suited for simulations: it is efficiently written in the simpler case where there is an equal number of observations per region/sector.
